<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sistema de Previsão de Handicap Asiático</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <div class="container">
        <h1>Sistema de Previsão de Handicap Asiático</h1>
        
        <div class="tabs">
            <button class="tablinks active" onclick="openTab(event, 'previsao')">Fazer Previsão</button>
            <button class="tablinks" onclick="openTab(event, 'ferramentas')">Ferramentas Avançadas</button>
            <button class="tablinks" onclick="openTab(event, 'historico')">Histórico</button>
            <button class="tablinks" onclick="openTab(event, 'dados-api')">Dados da API</button>
            <button class="tablinks" onclick="openTab(event, 'configuracoes')">Configurações</button>
            <button class="tablinks" onclick="openTab(event, 'ajuda')">Ajuda</button>
        </div>
        
        <div id="configuracoes" class="tabcontent">
            <h2>Configurações do Modelo</h2>
            <div class="panel">
                <h3>Parâmetros do Modelo</h3>
                <div class="form-group">
                    <label for="limiar-decisao">Limiar de Decisão:</label>
                    <input type="number" id="limiar-decisao" step="0.05" min="0" max="1" value="0.20">
                    <small>Quanto maior o valor, mais conservador será o modelo (menos apostas, maior confiança)</small>
                </div>
                
                <div class="form-group">
                    <label for="peso-form-recente">Peso da Forma Recente:</label>
                    <input type="number" id="peso-form-recente" step="0.05" min="0" max="2" value="1.00">
                    <small>Quanto maior o valor, mais peso será dado aos jogos recentes</small>
                </div>
                
                <div class="form-group">
                    <label for="peso-confrontos">Peso dos Confrontos Diretos:</label>
                    <input type="number" id="peso-confrontos" step="0.05" min="0" max="2" value="0.70">
                    <small>Quanto maior o valor, mais peso será dado ao histórico de confrontos diretos</small>
                </div>
                
                <div class="form-group">
                    <label for="estrategia-stake">Estratégia de Stake:</label>
                    <select id="estrategia-stake">
                        <option value="fixo">Stake Fixo</option>
                        <option value="kelly">Critério de Kelly</option>
                        <option value="kelly-fracionario">Kelly Fracionário (50%)</option>
                    </select>
                </div>
                
                <h3>Configurações da API</h3>
                <div class="form-group">
                    <label for="api-key">Chave da API (API Token):</label>
                    <input type="text" id="api-key" placeholder="Insira seu token da API Football-Data.org aqui">
                    <small>Necessária para fazer consultas à API de futebol</small>
                </div>
                
                <div class="form-group">
                    <label for="limite-requisicoes">Plano da API:</label>
                    <select id="plano-api" disabled>
                        <option value="free">Gratuito (10 chamadas/min)</option>
                        <option value="tier1">Tier 1</option>
                        <option value="tier2">Tier 2</option>
                    </select>
                    <small>O plano é detectado automaticamente com base no seu token</small>
                </div>
                
                <h3>Configurações das Ferramentas Avançadas</h3>
                <div class="form-group">
                    <label for="modo-avaliacao">Modo de Avaliação Automática:</label>
                    <select id="modo-avaliacao">
                        <option value="basico">Básico (Mais rápido)</option>
                        <option value="avancado" selected>Avançado (Recomendado)</option>
                        <option value="completo">Completo (Mais detalhado)</option>
                    </select>
                </div>
                
                <div class="form-group">
                    <label for="verificar-escalacoes">Verificar Escalações Automaticamente:</label>
                    <input type="checkbox" id="verificar-escalacoes" checked>
                    <small>Verificar lesões e desfalques ao analisar partidas</small>
                </div>
                
                <div class="form-group">
                    <label for="simulacao-montecarlo">Número de Simulações Monte Carlo:</label>
                    <select id="simulacao-montecarlo">
                        <option value="1000">1,000 (Rápido)</option>
                        <option value="5000" selected>5,000 (Padrão)</option>
                        <option value="10000">10,000 (Detalhado)</option>
                        <option value="50000">50,000 (Ultra Preciso)</option>
                    </select>
                    <small>Mais simulações produzem resultados mais precisos, mas consomem mais processamento</small>
                </div>
                
                <button class="button" onclick="salvarConfiguracoes()">Salvar Configurações</button>
            </div>
        </div>
        
        <div id="previsao" class="tabcontent" style="display: block;">
            <h2>Previsão de Handicap Asiático</h2>
            <div class="panel">
                <div class="form-group">
                    <label for="liga">Liga/Competição:</label>
                    <select id="liga">
                        <option value="PL">Premier League (Inglaterra)</option>
                        <option value="PD">La Liga (Espanha)</option>
                        <option value="BL1">Bundesliga (Alemanha)</option>
                        <option value="SA">Serie A (Itália)</option>
                        <option value="FL1">Ligue 1 (França)</option>
                        <option value="BSA">Brasileirão Série A</option>
                    </select>
                    <button class="button api-button" onclick="carregarTimesAPI()">Carregar Times da API</button>
                </div>
                
                <div class="grid-container">
                    <div>
                        <div class="form-group">
                            <label for="time-casa">Time Casa:</label>
                            <select id="time-casa">
                                <option value="">Selecione a liga primeiro</option>
                            </select>
                        </div>
                        
                        <div class="form-group">
                            <label>Últimos 5 jogos (Casa):</label>
                            <div id="ultimos-jogos-casa" style="margin-top: 10px;">
                                Não disponível
                            </div>
                            <button class="button small-button" onclick="carregarUltimosJogos('casa')">Carregar da API</button>
                        </div>
                    </div>
                    
                    <div>
                        <div class="form-group">
                            <label for="time-fora">Time Visitante:</label>
                            <select id="time-fora">
                                <option value="">Selecione a liga primeiro</option>
                            </select>
                        </div>
                        
                        <div class="form-group">
                            <label>Últimos 5 jogos (Visitante):</label>
                            <div id="ultimos-jogos-fora" style="margin-top: 10px;">
                                Não disponível
                            </div>
                            <button class="button small-button" onclick="carregarUltimosJogos('fora')">Carregar da API</button>
                        </div>
                    </div>
                </div>
                
                <div class="form-group">
                    <label>Histórico de confrontos:</label>
                    <div id="historico-confrontos" style="margin-top: 10px;">
                        Selecione os times para ver o histórico
                    </div>
                    <button class="button small-button" onclick="carregarConfrontosAPI()">Carregar Confrontos da API</button>
                </div>
                
                <h3>Informações da Aposta</h3>
                <div class="grid-container">
                    <div class="form-group">
                        <label for="handicap">Linha de Handicap Asiático:</label>
                        <select id="handicap">
                            <option value="2">+2.0 (Casa)</option>
                            <option value="1.75">+1.75 (Casa)</option>
                            <option value="1.5">+1.5 (Casa)</option>
                            <option value="1.25">+1.25 (Casa)</option>
                            <option value="1">+1.0 (Casa)</option>
                            <option value="0.75">+0.75 (Casa)</option>
                            <option value="0.5">+0.5 (Casa)</option>
                            <option value="0.25">+0.25 (Casa)</option>
                            <option value="0" selected>0 (Neutro)</option>
                            <option value="-0.25">-0.25 (Casa)</option>
                            <option value="-0.5">-0.5 (Casa)</option>
                            <option value="-0.75">-0.75 (Casa)</option>
                            <option value="-1">-1.0 (Casa)</option>
                            <option value="-1.25">-1.25 (Casa)</option>
                            <option value="-1.5">-1.5 (Casa)</option>
                            <option value="-1.75">-1.75 (Casa)</option>
                            <option value="-2">-2.0 (Casa)</option>
                        </select>
                    </div>
                    
                    <div class="form-group">
                        <label for="odds-casa">Odds Casa:</label>
                        <input type="number" id="odds-casa" step="0.01" min="1" value="1.90">
                    </div>
                    
                    <div class="form-group">
                        <label for="odds-fora">Odds Visitante:</label>
                        <input type="number" id="odds-fora" step="0.01" min="1" value="1.90">
                    </div>
                    
                    <div class="form-group">
                        <label for="valor-aposta">Valor da Aposta (opcional):</label>
                        <input type="number" id="valor-aposta" step="1" min="0" value="100">
                    </div>
                </div>
                
                <button class="button" onclick="fazerPrevisao()">Fazer Previsão</button>
                <div class="loader" id="loader"></div>
                
                <div id="resultado-previsao" style="margin-top: 20px; display: none;">
                    <h3>Resultado da Previsão</h3>
                    <div class="result" id="resultado-container">
                        <!-- Aqui vai o resultado -->
                    </div>
                    
                    <div id="detalhes-previsao" style="margin-top: 15px;">
                        <h4>Detalhes da Análise</h4>
                        <table>
                            <tr>
                                <th>Fator</th>
                                <th>Time Casa</th>
                                <th>Time Visitante</th>
                                <th>Impacto</th>
                            </tr>
                            <tbody id="tabela-detalhes">
                                <!-- Aqui vão os detalhes -->
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Nova aba para as ferramentas avançadas solicitadas -->
        <div id="ferramentas" class="tabcontent">
            <h2>Ferramentas Avançadas de Análise</h2>
            
            <!-- Ferramenta 1: Avaliação automática com pesos -->
            <div class="panel">
                <h3>1. Avaliação Automática com Pesos</h3>
                <p>Configure os pesos dos fatores para personalizar a análise dos times.</p>
                
                <div class="grid-container">
                    <div class="form-group">
                        <label for="peso-forma">Peso da Forma Recente:</label>
                        <input type="range" id="peso-forma" min="1" max="10" value="7" class="slider">
                        <span id="valor-peso-forma">7</span>
                    </div>
                    
                    <div class="form-group">
                        <label for="peso-mando">Peso do Mando de Campo:</label>
                        <input type="range" id="peso-mando" min="1" max="10" value="6" class="slider">
                        <span id="valor-peso-mando">6</span>
                    </div>
                    
                    <div class="form-group">
                        <label for="peso-confianca">Peso do Índice de Confiança:</label>
                        <input type="range" id="peso-confianca" min="1" max="10" value="5" class="slider">
                        <span id="valor-peso-confianca">5</span>
                    </div>
                </div>
                
                <div class="form-group">
                    <label for="time-analise">Selecione os times para análise:</label>
                    <div class="grid-container">
                        <select id="time-analise-casa">
                            <option value="">Selecione o time da casa</option>
                            <!-- Será preenchido via JavaScript -->
                        </select>
                        
                        <select id="time-analise-fora">
                            <option value="">Selecione o time visitante</option>
                            <!-- Será preenchido via JavaScript -->
                        </select>
                    </div>
                </div>
                
                <button class="button" onclick="realizarAvaliacaoAutomatica()">Realizar Avaliação Ponderada</button>
                
                <div id="resultado-avaliacao" style="margin-top: 20px; display: none;">
                    <h4>Resultado da Avaliação Ponderada</h4>
                    <div class="result-chart">
                        <canvas id="grafico-avaliacao"></canvas>
                    </div>
                    
                    <table class="table-result">
                        <thead>
                            <tr>
                                <th>Fator</th>
                                <th>Time Casa</th>
                                <th>Time Visitante</th>
                                <th>Diferença</th>
                            </tr>
                        </thead>
                        <tbody id="tabela-avaliacao">
                            <!-- Preenchido via JavaScript -->
                        </tbody>
                        <tfoot>
                            <tr>
                                <th>Total Ponderado</th>
                                <td id="total-casa"></td>
                                <td id="total-fora"></td>
                                <td id="diferenca-total"></td>
                            </tr>
                        </tfoot>
                    </table>
                </div>
            </div>
            
            <!-- Ferramenta 2: Simulação de múltiplos handicaps -->
            <div class="panel">
                <h3>2. Simulação de Múltiplos Handicaps</h3>
                <p>Compare todos os handicaps disponíveis para encontrar o valor ideal para sua aposta.</p>
                
                <div class="form-group">
                    <label>Selecione os times para simulação:</label>
                    <div class="grid-container">
                        <select id="time-sim-casa">
                            <option value="">Selecione o time da casa</option>
                            <!-- Será preenchido via JavaScript -->
                        </select>
                        
                        <select id="time-sim-fora">
                            <option value="">Selecione o time visitante</option>
                            <!-- Será preenchido via JavaScript -->
                        </select>
                    </div>
                </div>
                
                <div class="form-group">
                    <label>Faixa de Odds para Simulação:</label>
                    <div class="grid-container">
                        <div>
                            <label for="odds-min">Odds Mínima:</label>
                            <input type="number" id="odds-min" min="1.01" step="0.01" value="1.70">
                        </div>
                        
                        <div>
                            <label for="odds-max">Odds Máxima:</label>
                            <input type="number" id="odds-max" min="1.01" step="0.01" value="2.20">
                        </div>
                    </div>
                </div>
                
                <button class="button" onclick="simularMultiplosHandicaps()">Simular Todos os Handicaps</button>
                
                <div id="resultado-simulacao" style="margin-top: 20px; display: none;">
                    <h4>Resultado da Simulação de Handicaps</h4>
                    
                    <div class="chart-container">
                        <canvas id="grafico-handicaps"></canvas>
                    </div>
                    
                    <table class="table-result">
                        <thead>
                            <tr>
                                <th>Handicap</th>
                                <th>Probabilidade</th>
                                <th>Odds Justas</th>
                                <th>Valor Esperado</th>
                                <th>Recomendação</th>
                            </tr>
                        </thead>
                        <tbody id="tabela-handicaps">
                            <!-- Preenchido via JavaScript -->
                        </tbody>
                    </table>
                    
                    <div id="handicap-recomendado" class="highlight-box">
                        <h4>Handicap Recomendado</h4>
                        <p>Com base na análise, recomendamos o handicap <span id="valor-handicap-recomendado"></span> com odds de <span id="odds-recomendada"></span> <span id="time-recomendado"></span>.</p>
                        <p><strong>Vantagem esperada:</strong> <span id="vantagem-esperada"></span></p>
                    </div>
                </div>
            </div>
            
            <!-- Ferramenta 3: Verificação de escalações e lesões -->
            <div class="panel">
                <h3>3. Verificação de Escalações e Lesões</h3>
                <p>Analise o impacto das lesões e ausências nas equipes antes do jogo.</p>
                
                <div class="form-group">
                    <label>Selecione os times para verificação:</label>
                    <div class="grid-container">
                        <select id="time-escalacao-casa">
                            <option value="">Selecione o time da casa</option>
                            <!-- Será preenchido via JavaScript -->
                        </select>
                        
                        <select id="time-escalacao-fora">
                            <option value="">Selecione o time visitante</option>
                            <!-- Será preenchido via JavaScript -->
                        </select>
                    </div>
                </div>
                
                <button class="button api-button" onclick="verificarEscalacoesAPI()">Verificar Escalações e Lesões na API</button>
                
                <div class="escalacoes-container">
                    <div class="escalacao-time">
                        <h4>Escalação Provável <span id="nome-time-casa-escalacao"></span></h4>
                        <div class="field-container">
                            <div class="soccer-field">
                                <!-- Os jogadores serão posicionados aqui via JavaScript -->
                                <div class="player-positions" id="escalacao-casa">
                                    <!-- Posições serão inseridas via JavaScript -->
                                </div>
                            </div>
                        </div>
                        
                        <h5>Desfalques e Lesões</h5>
                        <ul id="desfalques-casa">
                            <!-- Preenchido via JavaScript -->
                            <li class="placeholder">Carregando dados...</li>
                        </ul>
                    </div>
                    
                    <div class="escalacao-time">
                        <h4>Escalação Provável <span id="nome-time-fora-escalacao"></span></h4>
                        <div class="field-container">
                            <div class="soccer-field away">
                                <!-- Os jogadores serão posicionados aqui via JavaScript -->
                                <div class="player-positions" id="escalacao-fora">
                                    <!-- Posições serão inseridas via JavaScript -->
                                </div>
                            </div>
                        </div>
                        
                        <h5>Desfalques e Lesões</h5>
                        <ul id="desfalques-fora">
                            <!-- Preenchido via JavaScript -->
                            <li class="placeholder">Carregando dados...</li>
                        </ul>
                    </div>
                </div>
                
                <div id="analise-escalacoes" style="margin-top: 20px; display: none;">
                    <h4>Análise do Impacto das Lesões</h4>
                    
                    <div class="impact-container">
                        <div class="impact-team">
                            <h5><span id="time-casa-lesoes"></span></h5>
                            <div class="impact-meter">
                                <div class="impact-bar" id="impacto-casa-bar"></div>
                                <span id="impacto-casa-valor"></span>
                            </div>
                            <p id="analise-casa-lesoes"></p>
                        </div>
                        
                        <div class="impact-team">
                            <h5><span id="time-fora-lesoes"></span></h5>
                            <div class="impact-meter">
                                <div class="impact-bar" id="impacto-fora-bar"></div>
                                <span id="impacto-fora-valor"></span>
                            </div>
                            <p id="analise-fora-lesoes"></p>
                        </div>
                    </div>
                    
                    <div class="conclusion-box">
                        <h5>Conclusão sobre Lesões e Desfalques</h5>
                        <p id="conclusao-lesoes"></p>
                    </div>
                </div>
            </div>
            
            <!-- Ferramenta 4: Geração de sugestão de aposta com justificativa -->
            <div class="panel">
                <h3>4. Sugestão de Aposta com Justificativa</h3>
                <p>Receba uma recomendação de aposta detalhada com análise completa dos fatores.</p>
                
                <div class="form-group">
                    <label>Selecione os times para análise:</label>
                    <div class="grid-container">
                        <select id="time-sugestao-casa">
                            <option value="">Selecione o time da casa</option>
                            <!-- Será preenchido via JavaScript -->
                        </select>
                        
                        <select id="time-sugestao-fora">
                            <option value="">Selecione o time visitante</option>
                            <!-- Será preenchido via JavaScript -->
                        </select>
                    </div>
                </div>
                
                <div class="form-group">
                    <label for="nivel-confianca">Nível de Confiança Mínimo:</label>
                    <select id="nivel-confianca">
                        <option value="0.50">50% - Qualquer aposta viável</option>
                        <option value="0.60">60% - Apostas promissoras</option>
                        <option value="0.70" selected>70% - Apostas recomendadas</option>
                        <option value="0.80">80% - Apostas de alta confiança</option>
                        <option value="0.90">90% - Apenas apostas premium</option>
                    </select>
                </div>
                
                <button class="button" onclick="gerarSugestaoAposta()">Gerar Sugestão de Aposta</button>
                
                <div id="resultado-sugestao" style="margin-top: 20px; display: none;">
                    <div class="suggestion-box">
                        <h4>Sugestão de Aposta</h4>
                        <div class="suggestion-highlight">
                            <span id="mercado-sugerido"></span>: <strong id="selecao-sugerida"></strong>
                            <div class="suggestion-details">
                                <span>Handicap: <strong id="handicap-sugerido"></strong></span>
                                <span>Odds: <strong id="odds-sugerida"></strong></span>
                                <span>Confiança: <strong id="confianca-sugerida"></strong></span>
                            </div>
                        </div>
                        
                        <h5>Stake Recomendado</h5>
                        <div class="stake-meter">
                            <div class="stake-bar" id="stake-bar"></div>
                            <span id="stake-valor"></span>/10
                        </div>
                        
                        <h5>Justificativa da Aposta</h5>
                        <div id="justificativa-aposta" class="justification-box">
                            <!-- Preenchido via JavaScript -->
                        </div>
                        
                        <h5>Fatores Considerados</h5>
                        <ul id="fatores-considerados">
                            <!-- Preenchido via JavaScript -->
                        </ul>
                        
                        <div class="additional-tips">
                            <h5>Dicas Adicionais</h5>
                            <ul id="dicas-adicionais">
                                <!-- Preenchido via JavaScript -->
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Ferramenta 5: Previsão de resultado correto -->
            <div class="panel">
                <h3>5. Previsão de Placar Correto</h3>
                <p>Veja os três placares mais prováveis para a partida baseados na análise estatística.</p>
                
                <div class="form-group">
                    <label>Selecione os times para previsão:</label>
                    <div class="grid-container">
                        <select id="time-placar-casa">
                            <option value="">Selecione o time da casa</option>
                            <!-- Será preenchido via JavaScript -->
                        </select>
                        
                        <select id="time-placar-fora">
                            <option value="">Selecione o time visitante</option>
                            <!-- Será preenchido via JavaScript -->
                        </select>
                    </div>
                </div>
                
                <div class="form-group">
                    <label for="modo-previsao">Modo de Previsão:</label>
                    <select id="modo-previsao">
                        <option value="estatistico">Estatístico (Baseado em histórico)</option>
                        <option value="avancado">Avançado (Inclui fatores de momento)</option>
                        <option value="completo">Completo (Todos os fatores + lesões)</option>
                    </select>
                </div>
                
                <button class="button" onclick="preverPlacarCorreto()">Prever Placares Prováveis</button>
                
                <div id="resultado-placar" style="margin-top: 20px; display: none;">
                    <h4>Placares Mais Prováveis</h4>
                    
                    <div class="scoreboard-container">
                        <div class="scoreboard" id="placar-1">
                            <div class="teams">
                                <div class="team" id="time1-placar1"></div>
                                <div class="team" id="time2-placar1"></div>
                            </div>
                            <div class="scores">
                                <div class="score" id="gols1-placar1"></div>
                                <div class="score" id="gols2-placar1"></div>
                            </div>
                            <div class="probability" id="prob-placar1"></div>
                        </div>
                        
                        <div class="scoreboard" id="placar-2">
                            <div class="teams">
                                <div class="team" id="time1-placar2"></div>
                                <div class="team" id="time2-placar2"></div>
                            </div>
                            <div class="scores">
                                <div class="score" id="gols1-placar2"></div>
                                <div class="score" id="gols2-placar2"></div>
                            </div>
                            <div class="probability" id="prob-placar2"></div>
                        </div>
                        
                        <div class="scoreboard" id="placar-3">
                            <div class="teams">
                                <div class="team" id="time1-placar3"></div>
                                <div class="team" id="time2-placar3"></div>
                            </div>
                            <div class="scores">
                                <div class="score" id="gols1-placar3"></div>
                                <div class="score" id="gols2-placar3"></div>
                            </div>
                            <div class="probability" id="prob-placar3"></div>
                        </div>
                    </div>
                    
                    <div class="
